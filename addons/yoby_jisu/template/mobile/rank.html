<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<title>排行榜</title>
<style type="text/css">
html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video { margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline; outline: none; }
body { font-family: Microsoft YaHei, Helvitica, Verdana, Tohoma, Arial, san-serif; -webkit-text-size-adjust: none; }
article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section { display: block; }
ol, ul { list-style: none; }
blockquote, q { quotes: none; }
blockquote:before, blockquote:after, q:before, q:after { content: ''; content: none; }
strong { font-weight: bold; }
a, button, input { -webkit-tap-highlight-color: rgba(255,0,0,0); }
input, textarea, select, button { -webkit-border-radius: 0; -webkit-appearance: none; outline: none; }
input[type="button"], input[type="submit"], input[type="reset"] { -webkit-appearance: none; }
table { border-collapse: collapse; border-spacing: 0; }
img { border: 0; }
a { text-decoration: none; }
a:hover { text-decoration: none; }
.clearfix:before, .container:after { content: ""; display: table; }
.clearfix:after { clear: both; }
.left { float: left; }
.right { float: right; }
/**/
body { background-color: #ffffff; }
.vgy_user { display: block; margin: 0; padding: 0; text-align: center; overflow: hidden; }
.vgy_user_bg { width: 100%; opacity: 0.15; }
.vgy_user .info2 { display: block; padding: 40px 0 0px 0;margin-bottom:5px; background: url("{php echo tomedia($row['ad_img'])}") no-repeat;background-size:100% 90% }
.vgy_user .info2 .touxiang { width: 100px; height: 100px; border-radius: 100%; background-color: #FFF; box-shadow: 0 0 0 3px rgba(255, 255, 255, 1), 0 0 10px 2px rgba(0, 0, 0, 0.3); }

.name { font-size: 16px; margin: 10px 0 10px 0; color:#fff; }
.dhm{ font-size:14px; color:#409f10; line-height:18px;}
.info2 a { color: #fff; }
.infotext { text-align: center; display: block; font-size: 48px; color: #fff; }
.infotext .syuan { font-size: 12px; }
.red { color: #F30 }
.time { font-size: 12px; color: #666 }

.bgs { background: -webkit-gradient(linear, 0% 100%, 0% 45%, from(#fff), to(rgba(255,255,255,0))) }
.bgt { width: 100%; opacity: 0 }
.Ranking { color:#fff;
padding: 5px 10px;
height: 26px;
line-height: 26px;
font-size: 12px;
background-color:#e74720;}
.list ul li { position: relative; border-bottom: 1px solid rgba(0, 0, 0, 0.05); padding: 6px 10px; overflow: hidden; position: relative; padding: 10px 0 10px 70px; }
.list ul li .Head { position: absolute; background: background-size: 100% 100%; left:25px; z-index:0; }
.list ul li .Head img { width: 42px; overflow: hidden; border-radius: 100%; border: 0; box-shadow: 0 0 0 3px rgba(255, 255, 255, 1);  }
.list ul li .text { margin: 0 8px; color: #aeaeae; font-size: 12px; text-align: left; }
.list ul li .text h1 {  font-size: 16px; color: #000000; line-height: 24px; }
.list ul li .text span{ color:#CCC; font-size:12px;}
.list ul li .text p { float:left; font-size: 14px; color:#e74720; line-height: 28px; padding:5px; }
.list ul li .text h2 { font-size: 12px; color: #B8B8B8;  }
.list ul li .his{  float:left;}
.list ul li .gift{ float:right;margin-left: 10px; }
.list ul li.more { padding: 10px; text-align: center; font-size: 14px; color: #666; display: block;}
.list ul li.more a { color: #666; }
.list ul li .NO{  z-index:1; font-size:12PX; position:absolute; left:10px; background-color:#feaf05; color:#fff; padding:2px 6px; border-radius:2px;}
.list ul li:nth-child(-n+3){ background-color:rgba(255, 253, 240, 0.57);}
.list ul li:nth-child(-n+3) .no{ background-color:#e74720; color:#fff;}
.sjbutton { background-color: #49c249; border-radius: 5px; border: 0; text-align: center; padding: 0 15px; height: 30px; line-height: 32px; color: #fff; font-family: Microsoft YaHei, Helvitica, Verdana, Tohoma, Arial, san-serif; }
.update { cursor: pointer; border-radius: 100%; background: rgba(255, 255, 255, 0.15); width: 18px; height: 18px; padding: 8px; position: absolute; right: 10px; top: 10px; text-align: center; }
.update img { width: 18px; height: 18px; }

.vgy_user ul {border-top: 1px solid rgba(0, 0, 0, 0.6); margin: auto; display: block; width: 100%; height: 48px; display: -webkit-box; display: box; -webkit-box-orient: horizontal; background-color: rgba(0, 0, 0, 0.5);}
.vgy_user ul li { width: auto!important; height: 100%; position: static; margin: 0; border-radius: 0; -webkit-box-sizing: border-box; box-sizing: border-box; -webkit-box-flex: 1; box-flex: 1; -webkit-box-sizing: border-box; box-shadow: none; background: none;padding: 5px 0 0 0;border-left: 1px solid rgba(0, 0, 0, 0.6);}
.vgy_user ul li:first-child {border-left: 0;}

.vgy_user ul li span { color:#fff424}
.vgy_user ul li p { margin: 2px 0 0 0; font-size: 12px; display: block ; line-height: 16px; text-align: center; color:rgba(255, 255, 255, 1)}
.vgy_user .tx{width: 120px;
display: inline-block;
font-size: 12px;
color: #fff;
border-radius:8px;
padding: 6px 0;
margin: 0 5px 15px 0;
border: 1px solid #c2300c;
background-color:#e74720;}
.vgy_user .tx:active{background-color: #c2300c;border:1px solid #e74720; color:#Fff;}

.back { left: 10px; top: 10px; }
footer{ background-color: #F6F6F6; color:#999; text-align:center; font-size:12px; padding:20px 0px;border-top: 1px solid #eaeaea;  width:100%;}

::-webkit-input-placeholder {color:#781d07}
:-moz-placeholder { color:#781d07;}
::-moz-placeholder {color:#781d07;}
:-ms-input-placeholder {color:#781d07;}

.pop{ position: absolute;	top:0;	left:0;right:0;	bottom:0;background:rgba(0, 0, 0, 0.7);z-index:1000;height: 100%; width:100%; }
.pop .box{
border-radius:20px;
background-color:#e74720;
position: fixed;
z-index: 1001;
left: 20px;
right: 20px;
top: 100px;

box-shadow:  0 1px 5px rgba(0, 0, 0, 0.32),0 -6px 0px 0px rgba(0, 0, 0, 0.15) inset;
}
#zjl .box{top: 50px; }
.pop .box h1{ color:#fff; text-align:center;padding: 10px 0;font-size: 16px;}
.pop .box h2{ color:#fff; font-size:12px; text-align:center;padding:0 5px 5px 5px;word-wrap: break-word;}
.pop .box .inputqy{ margin:5px 15px;overflow: hidden;}
.pop .box .inputqy input{
box-sizing: border-box;
padding: 10px;
background-color: #c2300c;
color: #fff;
border-radius:15px;
width: 100%;
margin: 5px auto;
font-size: 14px;
border: 1px #e95430 solid;
}
.pop .box .but_con{margin:10px 15px 20px 15px; overflow:hidden;}
.right {
float: right;}

.pop .box .w49{ width:49%;}
.pop .button_yes{
width: 100%;
text-align: center;
display: inline-block;box-sizing: border-box;
font-size: 16px;
font-weight:bold;
color: #fff;
border-radius:15px;
padding: 10px 0;
border: 1px solid #fdc71d;
background: #feaf05;
cursor: pointer;
}
.pop .button_yes:active{background:#fdc71d;color: #fff;}
.pop .button_no{
width: 100%;
text-align: center;
display: inline-block;box-sizing: border-box;
font-size: 16px;
color: #fff;
border-radius: 15px;
padding: 10px 0;
border: 1px solid #d52108;
background-color:transparent;
cursor: pointer;}
.pop .button_no:active{ background-color:#c2300c;}
.pop .jpimg{ text-align:center}
.pop .jpimg img{max-height: 240px;
max-width: 100%;
border-radius: 10px;
margin-bottom: 5px;}
.pop .jptext{ text-align:center; font-size:14px}
.pop .jptext .ncz{ margin:20px 0;display: block;color:#fff;}
.pop .box .closeb {
cursor: pointer;
position: absolute;
display: block;
border-radius: 50%;
width: 30px;
height: 30px;
text-indent: -9999px;
top: 5px;
right: 5px;
}
.pop .box .closeb:after {
position: absolute;
content: '.';
display: block;
width: 20px;
height: 1px;
background: #B9B9B9;
-webkit-transform: rotate(45deg);
top: 14px;
left: 5px;
}
.pop .box .closeb:before {
position: absolute;
content: '.';
display: block;
width: 20px;
height: 1px;
background: #B9B9B9;
-webkit-transform: rotate(-45deg);
top: 14px;
left: 5px;
}
</style>
</head>

<body>
<div class="vgy_user">
<div class="info2">
  			<a href="{php echo $_W['siteroot'].'app/'.$this->createMobileUrl('index',null,true).'&id='.$id;}">
            	<div class="update back"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAARVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////9SnXPCAAAAFnRSTlMA7zDPEGCff28ErlDfIPfMj41mV0AkVXw1LQAAANZJREFUWMPt1kkOAjEMRNHEmXpm9v2PChIS6WypijCIOsDbRN+K+/ZdRo5TdKJISZUixaCPLUJxtk29wM5zoCReXzuSnExyCvLuOychjtIdPwPOoEp5+Mx3wkpyIpIF38m4g2ex8PMaYAfPYvb8vMSA02T6+SysOW0Wv+PIzkmO00VxdVCpXliSJlBaWFIMHaRsRXK5gxSiFam0XwfK2fZiRqrhXc2E10MarOTSRZoiJlkMbycJmLDF8Ko0g5Lp8CqESWeHbj3UO4BtnDTcHGPjKbr/3t0ddlE0A42fh+MAAAAASUVORK5CYII="></div>
            </a>
   <?php
            $u = pdo_fetch("SELECT * FROM ".tablename($this->t_fans)." WHERE weid = '".$this->weid."' and openid='$openid' ");
           
            
            ?>
              				<img class="touxiang" src="{$u['headimgurl']}">
  			    		<p class="name">{$u['nickname']}</p> 
    		{if empty($isreg)}
    		<a href="javascript:;" class="tx" id="btn">我要领奖</a>
         {/if}               <ul>
<li><span>{$z}</span><p>最高记录</p></li>
    			<li><span>{$top}</span><p>排行</p></li>
</ul>
    		<div class="Ranking">
      			<div class="left">参与人数：{$n}人</div>
    		</div>
  		</div>
</div>            		
<div class="list">
    	<ul id="rank_list">
      {loop $list $k $item}
     <?php
           
                ?>
          <li>
      <div class="NO">{$item['rank']}</div>
        <div class="Head"><img src="{$item['headimgurl']}" width="100%"></div>
        <div class="text">
        <div class="his">  <h1>{$item['nickname']} <span></span></h1>
          <h2>{php echo hidetel($item['phone'])}</h2>
        </div>
        
         <div class="gift"> <p><span>玩</span>{$item['play_num']}<span>次,最多粽子</span>{$item['max_fen']}<span>个</span></p></div>
          
        </div>
      </li>
    
     {/loop}
      		        </ul>    
        <ul id="more_ul">
            
        </ul>
          	</div>
    <footer>&copy;{php echo date('Y')} {$row['copyright']}</footer>
    <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js" type="text/javascript" type="text/javascript" charset="utf-8"></script>
    <input id="done" type="hidden" value="0" >
    <div id="mzj" class="pop" style="display:none;">
        <div class="box">
            <h1>小提示</h1>
            <div class="inputqy">
            	<div class="jptext"><span id="ncz" class="ncz">您已经提交信息了！</span></div>
            </div>
        </div>
    </div>
    <div id="mcovear" class="pop" style="display:none;">
      <div class="box">
      	<b class="closeb" onClick="document.getElementById('mcovear').style.display='none';" ></b>
        <h1>填写您的资料</h1>
        <div class="inputqy">
            <h2 id="error_tip"></h2>
          	<input type="text" id="true_name" placeholder="请填入真实的姓名" />
          	<input type="tel" id="phone" placeholder="请输入手机号码，以便领取奖品" />
        </div>
        <div class="but_con"  >
            <button class="button_yes" onClick="sendtel()">确定</button>
            <div class="clr"></div>
          </div>
      </div>
    </div>        
    <script type="text/javascript">
$(function() {
$("#btn").click(function() {
if($("#done").val() == 1) {
$("#mzj").show();
setTimeout(function() {
$("#mzj").hide();
}, 1500);
} else {
$("#mcovear").show();	
}
});
});

var send_btn = false;
function sendtel() {
var true_name = $("#true_name").val();
	var reg_tel=new RegExp("^1[3,5,4,7,8]{1}[0-9]{9}$");
var phone = $("#phone").val();
if(true_name == '') {
$("#error_tip").text('请填入真实的姓名');
$("#true_name").focus();
return;
}
if(phone == '') {
$("#error_tip").text('请输入手机号码，以便领取奖品');
$("#phone").focus();
return;
} else if(!reg_tel.test(phone)){
		$("#error_tip").text('请输入正确手机格式.');
		$("#phone").focus();
		return;
	}
var submitData = {
"true_name" : true_name,
"phone" : phone,
};
if(send_btn) return;
send_btn = true;
$.ajax({
type : "POST",
url : "{php echo $_W['siteroot'].'app/index.php?i='.$_W['uniacid'].'&c=entry&do=saveindex&m='.$this->mod_name.'&id='.$id;}",
data : submitData,
contentType: "application/x-www-form-urlencoded; charset=utf-8",
dataType : "json",
success : function(data){
send_btn = false;
if(data.done == 'true') {
$("#error_tip").text('');
$("#mcovear").remove();
$("#done").val('1');
$("#btn").hide();
location.reload(true);
} else {
$("#error_tip").text(data.msg);
}
},
timeout : 15000,
error : function(xhr, type){
send_btn = false;
alert('网路不稳定，请稍候重试');
}
});
}
</script>
<script src="http://libs.baidu.com/zepto/0.8/zepto.min.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<?php
$wx = $_W['account']['jssdkconfig'];
$wx['url'] ='http://'.$_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'] ;
?> 
<script>
    var appIdstr = "{$wx['appId']}";
    var timestampstr = "{$wx['timestamp']}";
    var nonceStrstr = "{$wx['nonceStr']}";
    var signaturestr = "{$wx['signature']}";
wx.config({
	debug: false,
	appId: appIdstr,
	timestamp: timestampstr,
	nonceStr: nonceStrstr,
	signature: signaturestr,
	jsApiList: [
		'checkJsApi',
		'onMenuShareTimeline',
		'onMenuShareAppMessage','showMenuItems','hideOptionMenu'
		]
});
wx.ready(function () {
//要分享的数据
  var shareData = {
    title:"{$row['share_title']}",
    desc: "{$row['share_desc']}",
    link:"{$row['share_url']}" ,
    imgUrl:"{php echo tomedia($row['share_img']);}",
    type:'', 
    dataUrl:'',
  };

		wx.hideOptionMenu();
		wx.showMenuItems({
			menuList: [
			'menuItem:share:timeline', 
			'menuItem:share:appMessage',
			"menuItem:share:qq",
			//'menuItem:copyUrl',
			],
		});    
//分享给朋友
wx.onMenuShareAppMessage({
      title: shareData.title,
      desc: shareData.desc,
      link: shareData.link,
      imgUrl:shareData.imgUrl,
      type: shareData.type,
    dataUrl: shareData.dataUrl,
      trigger: function (res) {//菜单
        
      },
      success: function (res) {//成功
        
      },
      cancel: function (res) {//取消
        
      },
      fail: function (res) {//失败
        alert(JSON.stringify(res));
      },
      complete:function(res){//完成
      
      },
    });	

//分享到朋友圈
    wx.onMenuShareTimeline({
      title: shareData.title+shareData.desc,
      link: shareData.link,
      imgUrl:shareData.imgUrl,
      trigger: function (res) {
        
      },
      success: function (res) {
  $.post("{php echo $_W['siteroot'].'app/index.php?i='.$_W['uniacid'].'&c=entry&do=share&m='.$this->mod_name;}",{id:{$id},openid:"{$_W['openid']}"},function(data){   
if(data==1){
alert('分享朋友圈成功,今天能多玩'+{$row['sharenum']}+'次游戏,多次分享无效!');
} else{
alert('今天分享朋友圈一次机会已使用,多次分享无效');
}
});      
      },
      cancel: function (res) {
       
      },
      fail: function (res) {
        alert(JSON.stringify(res));
      },
      complete:function(res){//完成
      	 //alert('完成');
      },
    });	

});
</script>
</body>
</html>
