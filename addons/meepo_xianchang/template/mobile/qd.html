{template 'pc_header'}
<link rel="stylesheet" type="text/css" href="{MODULE_URL}template/mobile/app/css/screen_lottory_free.css">

    <style>
	::-webkit-scrollbar-track-piece { 
	background-color: rgba(0,0,0,0);
	border:0;border-radius: 8px; 
	} 
	::-webkit-scrollbar {
	width: 8px; 
	height: 8px; 
	border:0;
	border-radius: 8px; 
	} 
	::-webkit-scrollbar-thumb { 
	background-color: rgba(0,0,0,0); 
	background-clip: padding-box; 
	min-height: 28px; 
	border:0;
	border-radius: 8px;
	} 
	::-webkit-scrollbar-thumb:hover { 
	background-color: rgba(0,0,0,0);
	border:0;
	border-radius: 8px;
	} 
	.member-list {
	height: 70%;
	overflow: scroll;
	} 
	.qiandao{
	background-color: rgba(0, 0, 0, 0.3);
	height: 100%;
	width: 100%;
	overflow: auto; 
	position:relative;
	} 
	.tuchu{
	position: absolute; 
	top: 0; 
	left: 0; 
	bottom:0;
	right:0;
	background-color:rgba(0,0,0,0.75); 
	z-index:2;
	display:none
	} 
		.tuchug {
	border-radius:100%;
	top:50%;
	left:50%;
	margin:-350px 0 0 -350px;
	width:700px;
	height:700px;
	position:absolute;
	z-index:4;
}
.tuchuk {
	background-color:#FFF;
	border-radius:10px;
	top:50%;
	left:50%;
	margin:-200px 0 0 -150px;
	width:300px;
	height:400px;
	position:absolute;
	z-index:4;
}
.tx {
	width:226px;
	height:226px;
	border-radius:100%;
	overflow:hidden;
	margin:40px 37px 15px 37px;
}
.xm {
	font-size:20px;
	color:#000;
	overflow:hidden;
	white-space:nowrap;
	text-overflow:ellipsis;
	padding:12px 0;
	text-align:center;
	position:absolute;
	bottom:0;
	margin:0;
	width:100%;
	background-color:rgba(245,245,245,0.57);
	border-radius:0 0 10px 10px;
}
.pm {
	font-size:20px;
	text-align:center;
	background-color:rgba(255,255,255,1);
	color:#000;
	margin:15px auto;
	padding:0;
	border-radius:100px;
	width:75%;
}
.pm .red {
	color:#ff7575;
}
.tuchu.view {
	display:block;
	-webkit-animation:vp 0.5s 8s ease forwards;
	-moz-animation:0.5s 8s ease forwards;
}
.view .tuchuk {
	-webkit-animation:vv 8s 0s ease forwards;
	-moz-animation:8s 0s ease forwards;
}
.view .tuchug {
	-webkit-animation:vg 6.5s 1s ease forwards;
	-moz-animation:6.5s 1s ease forwards;
	opacity:0;
}
@-webkit-keyframes vv {
	0% {
	-webkit-transform:scale(0.1);
	opacity:0;
}
10% {
	-webkit-transform:scale(1.5);
	opacity:1;
}
20% {
	-webkit-transform:scale(1);
	opacity:1;
}
90% {
	-webkit-transform:scale(1);
	opacity:1;
}
100% {
	-webkit-transform:scale(0);
	opacity:0;
}
}@-webkit-keyframes vp {
	0% {
	-webkit-transform:scale(1);
	opacity:1;
}
100% {
	-webkit-transform:scale(1);
	opacity:0;
}
}@-webkit-keyframes vg {
	0% {
	-webkit-transform:rotate(0);
	opacity:0;
}
10% {
	-webkit-transform:rotate(0);
	opacity:1;
}
90% {
	-webkit-transform:rotate(60deg);
	opacity:1;
}
100% {
	-webkit-transform:rotate(70deg);
	opacity:0;
}
}.qiandao ul {
	list-style:none;
	margin:0;
	padding:20px;
	box-sizing:border-box;
	overflow:hidden;
}
.qiandao ul li {
	float:left;
	width:144px;
	height:144px;
	text-align:center;
	position:relative;
	padding:15px 0;
	opacity:0;
	display:none
}
.qiaodaotx {
	width:108px;
	height:108px;
	margin:0 auto;
	border-radius:100%;
	overflow:hidden;
	opacity:0;
	display:none
}
.qiaodaoxm {
	font-size:20px;
	color:#FFF;
	overflow:hidden;
	white-space:nowrap;
	text-overflow:ellipsis;
	margin:0 auto;
	padding:10px 0;
	opacity:0;
	display:none
}
.qiaodaopm {
	position:absolute;
	font-size:16px;
	top:105px;
	left:50%;
	background-color:rgba(255,255,255,1);
	color:#000;
	padding:0;
	border-radius:100px;
	width:60px;
	margin:0;
	margin-left:-30px;
	/*box-shadow:0px 1px 5px rgba(0,0,0,0.44);
	*/opacity:0;
	display:none
}
.qiandao ul li.qiaodaosf {
	display:block;
	opacity:1;
}
.qiandao ul li.qiaodaoxs {
	display:block;
	opacity:1;
	-webkit-animation:xs 1s 0s ease forwards;
	-moz-animation:1s 0s ease forwards;
}
.qiaodaosf .qiaodaotx {
	-webkit-animation:f1 1.2s 0.5s ease forwards;
	-moz-animation:2s 0.5s ease forwards;
	display:block
}
.qiaodaosf .qiaodaopm {
	-webkit-animation:mc 1.2s 1.5s ease forwards;
	-moz-animation:2s 1.5s ease forwards;
	display:block
}
.qiaodaosf .qiaodaoxm {
	-webkit-animation:mc 1.2s 2s ease forwards;
	-moz-animation:2s 2s ease forwards;
	display:block
}
.qiandao ul li.showqiaodao {
	display:block;
	opacity:1;
}
.showqiaodao .qiaodaotx {
	opacity:1;
	display:block
}
.showqiaodao .qiaodaopm {
	opacity:1;
	display:block
}
.showqiaodao .qiaodaoxm {
	opacity:1;
	display:block
}
@-webkit-keyframes f1 {
	0% {
	-webkit-transform:scale(0.1);
	opacity:0;
}
70% {
	-webkit-transform:scale(1.5);
	opacity:1;
}
100% {
	-webkit-transform:scale(1);
	opacity:1;
}
}@-webkit-keyframes mc {
	0% {
	opacity:0;
}
100% {
	opacity:1;
}
}@-webkit-keyframes xs {
	0% {
	opacity:1;
	-webkit-transform:scale(1);
}
100% {
	opacity:0;
	-webkit-transform:scale(0);
}
}#ddd {
	display:none;
}
</style>
<script src="{MODULE_URL}template/mobile/app/js/qdbase.js?20154223" type="text/javascript" charset="utf-8"></script>
<script src="{MODULE_URL}template/mobile/app/js/screen_qd.js" type="text/javascript" charset="utf-8"></script>
</head>
<body class="FUN WALL" {if !empty($basic_config['bg_vedio'])}data-vide-bg="{php echo tomedia($basic_config['bg_vedio'])}"{/if}>

    {template 'top_panel'}
    <div class="Panel Lottery" style="display: block; opacity: 1;">
      <div class="tuchu ">
        <div class="tuchug">
          <img src="{MODULE_URL}template/mobile/app/images/icon/bbb.png"></div>
        <div class="tuchuk">
          <img class="tx" id="qdtx" src="http://wx.qlogo.cn/mmopen/ctSue0WnfibLR4ponCgXLv4G9Y43YFEXv5UboZuvHbvwkz6QXEYvw4RyuktMxhicq22efPTnwhPRhT67FIia2dmKDlIb4falNbN/132">
          <p class="pm">第
            <span class="red" id="qdnums">0</span>位签到</p>
          <p class="xm" id="qdname">官方签到女神</p></div>
      </div>
      <div class="qiandao" id="ddd" style="display: none;">
        <ul id="divDetail">
		{loop $qds $key $row}
          <li id="dh{php echo $key+1}">
            <img class="qiaodaotx" id="hd{php echo $key+1}" src="{$row['avatar']}">
            <p class="qiaodaoxm" id="nc{php echo $key+1}">
			{if $bd_config['show']==0}
				{$row['nick_name']}
			{else}
				{loop $lottory_show $key2 $vals}
				{if $key2>0}&nbsp;&nbsp;{/if}
				{$row['bd_data'][$vals]}
				{/loop}
			{/if}
			</p>
            <p id="qd{php echo $key+1}" class="qiaodaopm">{php echo $key+1}</p>
		  </li>
		{/loop}
        </ul>
      </div>
      <script>
	  function senddh(n) {

          var count2 = $('#divDetail li').size();//0
          //div.scrollTop;
          if (n <= count2) {//无人签到
            $("#dh" + n).addClass('qiaodaosf');

            var div = document.getElementById('divDetail');

            document.getElementById('ddd').scrollTop = div.scrollHeight;
            n = n + 1;
            setTimeout("senddh(" + n + ")", 500);
          } else {
            //setTimeout("senddh2("+n+")",60000);
            setTimeout("getjson(" + {$qd_maxid} + ")", 1000);
          }

        }

        function senddh2(n) {

          //div.scrollTop;
          if (n > 0 && window.ssss != 0) {
            $("#dh" + n).removeClass('qiaodaosf');

            var div = document.getElementById('divDetail');

            document.getElementById('ddd').scrollTop = div.scrollHeight;
            n = n - 1;
            setTimeout("senddh2(" + n + ")", 500);
          } else {
            setTimeout("senddh(" + n + ")", 1000);
          }

        }

        var mid;
        var b;
        var ssss = 0;
        var ii = {$qd_nums};
        function getjson(v) {

          $(".tuchu").removeClass('view');
          $.getJSON(Path_url('new_qd'), {
				rid: scene_id,
				mid: v
			},
          function(result) {

            var b = result.mid;//最大的id

            var omid = result.omid;//老的最大的
            window.mid = b;
            if (omid < b) {
              window.ii = window.ii + 1;
              window.ssss = 0;
              var i = $('#divDetail li').size() + 1;

              $("#qdtx").attr("src", result.avatar);
              $("#qdnums").html(result.qdnums);
			  var thtml = ''
				if(bd_show ==1 && lottory_show.length>0){
					for(var i=0;i<lottory_show.length;i++){
					  if(lottory_show[i]!='mobile'){
						thtml += "&nbsp;&nbsp;&nbsp;"+result.bd_data[lottory_show[i]]||' ';	
					  }else{
						result.bd_data[lottory_show[i]] = result.bd_data[lottory_show[i]].replace(/(\d{3})\d{4}(\d{4})/, '$1****$2');
						thtml += "&nbsp;&nbsp;&nbsp;"+result.bd_data[lottory_show[i]]||' ';
					  }
					}	
				}else{
					thtml += result.nick_name;
				}
              $("#qdname").html(thtml);
              $(".tuchu").addClass('view');

              setTimeout(function() {
                var item = '<li id="dh' + i + '" class="qiaodaosf" ><img class="qiaodaotx"  id="hd' + i + '" src="' + result.avatar + '"><p id="nc' + i + '" class="qiaodaoxm">' + thtml + '</p><p id="qd' + i + '" class="qiaodaopm">' + result.qdnums + '</p></li>';
                $('#divDetail').append(item);
                var div = document.getElementById('divDetail');
                document.getElementById('ddd').scrollTop = div.scrollHeight;
              },
              7000);

            } else {
              window.ssss = window.ssss + 1;//1

              if (window.ssss > 1) {
                var s = $('#divDetail li').size() + 1;//2
                var sjs = Math.floor(Math.random() * s);
				if(sjs!=0){
				  
				
                $("#qdtx").attr("src", $("#hd" + sjs).attr("src"));
                $("#qdnums").html($("#qd" + sjs).html());
                $("#qdname").html($("#nc" + sjs).html());
                $(".tuchu").addClass('view');
				}
              }
            }

            setTimeout("getjson(" + b + ")", 10000);
          });

        }</script>
</div>
{template 'pc_footer'}