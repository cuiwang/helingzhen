{template 'header'}
<style>
input[type="textarea"] {
height: 60px;
}
</style>

<link type="text/css" rel="stylesheet" href="../addons/bm_hospital/template/css/online_booking.css">
<link rel="stylesheet" type="text/css" href="../addons/bm_hospital/template/css/common.css" media="all">
<link rel="stylesheet" type="text/css" href="../addons/bm_hospital/template/css/pig-ui.css" media="all">

   
    <ul class="round">

        <div class="">
            <ul class="round">
                <li class="title mb">
                    <span class="none">请认真填写在线预约信息！</span>
                </li> 
                <li class="nob" id="namea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>姓名</th>
                                <td>
                                    <input name="truename" type="text" class="px" id="truename" value="" placeholder="请输入真实姓名" data-validation-engine="validate[required,minSize[2],maxSize[8]]" data-errormessage-value-missing="必填项" data-prompt-position="bottomLeft"></td>
                            </tr>
                        </tbody>
                    </table>
                </li>
                <li class="nob" id="namea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>身份证</th>
                                <td>
                                    <input name="idno" type="text" class="px" id="idno" value="" placeholder="请输入身份证号码" data-validation-engine="validate[required,minSize[18],maxSize[18]]" data-errormessage-value-missing="必填项" data-prompt-position="bottomLeft"></td>
                            </tr>
                        </tbody>
                    </table>
                </li>				
                <li class="nob" id="namea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>性别</th>
                <td>
                                 <label class="radio inline"><input type="radio" name="sex" id="sex" class="answer2" value="1" {if $item['sex']=='1'}checked{/if} />男士</label> 
                                 <label class="radio inline"><input type="radio" name="sex" id="sex" class="answer2" value="2" {if $item['sex']=='2'}checked{/if} />女士</label> 
                </td>
                            </tr>
                        </tbody>
                    </table>
                </li>
                <li class="nob" id="phonea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>手机</th>
                                <td>
                                    <input name="mobile" type="text" class="px" id="mobile" value="" placeholder="请输入您的手机" data-validation-engine="validate[required,minSize[11],maxSize[11]]" data-errormessage-value-missing="必填项" data-prompt-position="bottomLeft"></td>
                            </tr>
                        </tbody>
                    </table>
                </li>
                <li class="nob" id="diseasea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>预约专家</th>
                                <td>
									<input name="profession" type="text" class="px" id="profession" readonly data-prompt-position="bottomLeft" value="{$project['ser_name']}"></td>	
                            </tr>
                        </tbody>
                    </table>
                </li>
				<input name="project_id" type="hidden" class="px" id="project_id" readonly data-prompt-position="bottomLeft" value="{$project['id']}">
				<input name="classify_id" type="hidden" class="px" id="classify_id" readonly data-prompt-position="bottomLeft" value="{$project['classify_id']}">
				<input name="srvtime" type="hidden" id="srvtime" readonly data-prompt-position="bottomLeft" value="{$project['srvtime']}">				
                <li class="nob" id="diseasea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>所属科室</th>
                                <td>
									<input name="ser_window" type="text" class="px" id="ser_window" readonly data-prompt-position="bottomLeft" value="{$project['ser_window']}"></td>	
                            </tr>
                        </tbody>
                    </table>
                </li>	
                <li class="nob" id="diseasea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>门诊时间</th>
                                <td>
									<textarea  readonly="true" cols="25">{$project['srvtime']}</textarea>
									<!--<input name="srvtime" type="textarea" id="srvtime" readonly="true" data-prompt-position="bottomLeft" value="{$project['srvtime']}">-->
								</td>	
                            </tr>
                        </tbody>
                    </table>
                </li>								
                <li class="nob" id="diseasea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>预约时间</th>
                                <td>
                                    <input name="restime" type="text" class="px" id="restime" value="" placeholder="请填写预约时间！"></td>
                            </tr>
                        </tbody>
                    </table>
                </li>

                <li class="nob" id="diseasea">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tbody>
                            <tr>
                                <th>备注</th>
                                <td>
                                    <input name="info" type="text" class="px" id="info" value="" placeholder="以上如有不足或有其它要求，请在此填写！"></td>
                            </tr>
                        </tbody>
                    </table>
                </li>
                <li class="title mb">
				{$order_info}
                </li> 
            </ul>
        </div>
    </ul>
    <div class="footReturn">
        <input id="showcard" class="submit" value="提交预约" type="button" style="width: 100%;cursor: pointer;">    
        <div class="window" id="windowcenter">
            <div id="title" class="wtitle">
                操作提示
                <span class="close" id="alertclose"></span>
            </div>
            <div class="content">
                <div id="txt"></div>
            </div>
        </div>
    </div>

<script type="text/javascript">

$("#showcard").bind("click",
function() {

    var btn = $(this);
    var truename    = $("#truename").val();
    var mobile      = $("#mobile").val();
    var idno      = $("#idno").val();	
    var info        = $("#info").val();
    var ser_name   = "{$project['ser_name']}";
    var reid       = "{$project['id']}";
	var project_id = $("#project_id").val();
	var classify_id = $("#classify_id").val();
	var sex        = $("input[name='sex']:checked").val();
	var restime    = $("#restime").val();

	if (sex == undefined) {
        alert("请选择性别");
        return
    }	
    //var portrait       = $("#portrait").val();
    if (mobile == '') {
        alert("请认真输入手机号");
        return
    }
    reg=/^(13[0-9]|14[0-9]|15[0-9]|18[0-9])\d{8}$/;
    if(!reg.test(mobile)){
		alert("请输正确手机号！");
		return;
    }
	 
    if (truename == '') {
        alert("请输入真实姓名");
        return
    }
	
    if (idno == '') {
        alert("请输入身份证号");
        return
    }	
    reg=/^\d{15}|\d{}18$/;
    if(!reg.test(idno)){
		alert("请输入正确身份证号！");
		return;
    }

    // if(wecha_id == ''){
    //   alert("您可能没有关注我们的微信号,因此不能提交信息.请关注后再来.");
    //   return;
    // }

    var submitData = {
        truename  : truename,
        mobile    : mobile,
        ser_name  : ser_name,
        info      : info,
        reid      : reid,
		project_id : project_id,
		classify_id : classify_id,
		idno       : idno,
		sex        : sex,
		restime    : restime			
    };
    $.post("{php echo $this->createMobileUrl('yysave')}", submitData,
    function(data) {
        if(1==data.errno){

            //setTimeout("window.location.href = location.href",2000);
            alert('预约单已提交！');
            location.href = data.url;
        }else if(2 == data.errno){
            alert('提交信息不对,请重新输入,或者联系我们');
        }else if(3 == data.errno){
            alert(data.msg);
            location.href = data.url;
        }else{
          alert("非常抱歉,请重新打开此页面.");
        }
    },
    "json")
});

</script>

{template 'footer'}